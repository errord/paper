# §2.6 统计检验与稳健性论证框架

## 2.6.1 策略绩效的统计显著性

投资策略的样本外绩效可能仅是随机波动的结果。为确保结论的科学性，本文对所有策略比较进行严格的统计检验。

### 检验一：Ledoit-Wolf夏普比率检验

Ledoit与Wolf（2008）提出了基于HAC（异方差自相关一致）估计量的夏普比率差异检验，适用于非正态、序列相关的收益率数据。

- **原假设**：$H_0: SR_A = SR_B$
- **备择假设**：$H_1: SR_A \neq SR_B$
- **检验统计量**：基于收益率差的HAC方差估计，构造渐近正态z统计量

**选择理由：** 传统t检验假设收益率独立正态，在金融数据中不成立。Ledoit-Wolf检验允许异方差性和序列相关性，对金融时间序列更为合适。

### 检验二：分块Bootstrap检验

采用分块Bootstrap（Block Bootstrap, Politis & Romano, 1994）保持收益率序列的时间依赖结构。

- **分块长度**：$b = \lfloor\sqrt{T}\rfloor$（约22天，一个月）
- **Bootstrap次数**：$B = 10000$
- **检验方法**：构建策略Sharpe差异的Bootstrap分布，计算经验p值

$$
p_{boot} = \frac{1}{B}\sum_{b=1}^{B} \mathbf{1}\left[SR_A^{(b)} - SR_B^{(b)} > SR_A^{obs} - SR_B^{obs}\right]
$$

**选择理由：** Bootstrap不依赖渐近理论，在有限样本下（如474天OOS）比渐近检验更可靠。分块结构保留了收益率的自相关性。

### 检验三：Diebold-Mariano检验

Diebold与Mariano（1995）检验用于比较两个策略的预测能力差异。

- **损失函数**：$L_t = r_{A,t}^2 - r_{B,t}^2$（以组合方差为损失）
- **原假设**：$H_0: E[L_t] = 0$（两策略损失函数期望相等）
- **检验统计量**：

$$
DM = \frac{\bar{L}}{\hat{\sigma}_L / \sqrt{T}} \sim N(0,1)
$$

其中 $\hat{\sigma}_L$ 为损失差序列的长期方差（HAC估计）。

**选择理由：** DM检验聚焦于**风险预测**能力的比较（而非收益差异），与本文以风险管理为导向的研究目标一致。当DM统计量显著为负时，策略A的风险预测能力优于策略B。

---

## 2.6.2 多重比较修正

### 问题

当同时比较13个策略（12个策略 vs 等权基准 = 12次假设检验）时，存在多重比较问题：

$$
P(\text{至少一个假阳性}) = 1 - (1-\alpha)^{12} \approx 0.46 \quad (\alpha = 0.05)
$$

即在5%显著性水平下，约有46%的概率得到至少一个伪显著结果。

### Romano-Wolf逐步下降方法

本文采用Romano-Wolf方法（Romano & Wolf, 2005）控制族错误率（Family-Wise Error Rate, FWER），该方法相比Bonferroni修正更为powerful，且保持对收益率序列时间依赖结构的适应性。

**算法步骤：**

1. 对所有12个策略对，计算原始检验p值 $\{p_1, p_2, \ldots, p_{12}\}$
2. 按p值从小到大排序
3. 使用Bootstrap生成联合分布，逐步检验：
   - 从最显著的策略对开始，若Bootstrap调整后的p值 $< \alpha$，则拒绝该原假设
   - 继续下一个，直到无法拒绝为止

**优势：**
- 控制FWER在 $\alpha$ 水平以下；
- 比Bonferroni修正（$\alpha/m$）更powerful（拒绝更多真阳性）；
- 适应收益率序列的时间依赖结构。

---

## 2.6.3 模型稳健性检验

本文设计了七项稳健性检验，系统评估策略结论对模型假设和参数选择的敏感性：

### （1）网络过滤方法稳健性

**检验内容：** 比较PMFG、MST和Graphical LASSO三种网络构建方法下，网络正则化RP的配置结果。

**检验逻辑：** 若策略的优势仅在特定网络过滤方法下成立，则结论的一般性存疑。

**实施方式：**
- 对三种网络分别计算中心性和社区结构
- 将各自的中心性输入NRRP，运行滚动回测
- 比较三种网络下NRRP的Sharpe、最大回撤等指标

### （2）窗口长度敏感性

**检验内容：** 对 $\tau \in \{126, 189, 252, 378, 504\}$（半年至两年）进行敏感性分析。

**检验逻辑：** 窗口长度影响相关矩阵的估计精度和网络的时变捕捉能力。若结论对窗口选择高度敏感，表明策略在实际应用中可能不稳定。

**实施方式：**
- 对每个窗口长度运行NRRP的完整滚动回测
- 报告Sharpe随窗口长度的变化趋势
- 若Sharpe在 $\tau = 189 \sim 378$ 区间内保持稳定（变化 $<10\%$），则认为窗口选择稳健

### （3）样本期稳健性（市场状态分析）

**检验内容：** 划分牛市、熊市、震荡市三种市场状态，分别评估各策略绩效。

**市场状态划分方法：** 基于等权组合滚动收益率的21天均值判断：
- **牛市**：滚动均值 > 日均收益率 + 1个标准差
- **熊市**：滚动均值 < 日均收益率 - 1个标准差
- **震荡市**：介于两者之间

**检验逻辑：** 策略不应仅在特定市场条件下有效。理想的图模型融合策略应具备以下特征：
- 牛市中不显著落后于激进策略（如等权、MV）
- 熊市中提供显著的下行保护（低回撤、高于基准的Sharpe）
- 震荡市中保持稳定的正收益

### （4）中心性指标稳健性

**检验内容：** 将NRRP中的介数中心性分别替换为度中心性、特征向量中心性、接近中心性。

**检验逻辑：** 若不同中心性指标给出相似的配置结果，说明结论不依赖于特定中心性度量的选择。若差异显著，这一差异本身即是有价值的信息。

### （5）交易成本敏感性

**检验内容：** 在不同交易成本假设下重新评估策略净收益。

| 场景 | 单边交易成本 | 对应含义 |
|------|------------|----------|
| 无成本 | 0 bp | 理论上界 |
| 低成本 | 5 bp | 大额ETF交易 |
| 中等成本 | 10 bp | 个股中等规模交易 |
| 高成本 | 20 bp | 个股小规模交易 + 冲击成本 |

**交易成本扣除方式：** 在每个调仓时点，从组合收益中扣除：

$$
TC_t = tc_{bps} \times \sum_{i=1}^{n} |w_{i,t} - w_{i,t-1}|
$$

**检验逻辑：** 高换手策略（如均值方差、BL动量）在高交易成本下可能被低换手策略（如去噪RP、风险平价）反超。融合方法的实际可行性取决于扣除交易成本后是否仍具有经济显著性。

### （6）替代距离函数稳健性

**检验内容：** 比较标准距离 $d_{ij} = \sqrt{2(1-\rho_{ij})}$ 与替代距离 $d_{ij}' = \sqrt{1-\rho_{ij}^2}$ 构建的网络。

**比较指标：**
- 中心性秩相关（Spearman）：两种距离下同一资产的介数中心性排序是否一致
- MST边重叠（Jaccard）：两种距离下MST共享的边比例

**检验逻辑：** 若两种距离函数给出高度一致的网络结构，说明线性相关假设不是关键约束。

### （7）自适应调仓 vs 固定调仓

**检验内容：** 比较NRRP在以下两种调仓模式下的表现：
- **固定调仓**：每21天无条件重新优化
- **自适应调仓**：仅当 $J < 0.7$ 或 $NMI < 0.8$ 时触发重新优化

**比较指标：** Sharpe比率、换手率、交易成本扣除后的净Sharpe。

**检验逻辑：** 自适应调仓预期在网络稳定期减少不必要的换手，在网络剧变期及时响应。若自适应调仓能够以更低的换手率达到相近的Sharpe比率，则支持其在实际投资中的应用价值。

---

## 2.6.4 综合评价框架

为全面评价13种策略，本文构建多维评价体系：

### 绩效维度

| 维度 | 代表指标 | 权重 |
|------|----------|------|
| 收益能力 | 年化收益率、Calmar比率 | 30% |
| 风险控制 | 最大回撤、CVaR(95%)、年化波动率 | 40% |
| 风险调整收益 | Sharpe比率 | 20% |
| 实施成本 | 换手率、有效资产数 | 10% |

### 跨市场状态一致性

策略不应仅在单一市场状态下有效。定义"一致性得分"：

$$
CS = \frac{1}{3}\sum_{regime \in \{Bull, Bear, Sideways\}} \mathbf{1}\left[Rank_{regime} \leq 5\right]
$$

即在三种市场状态中，策略排名进入前5的比例。$CS = 1$ 表示在所有市场状态中均表现优秀。

### 统计可信度

结合三种统计检验和Romano-Wolf多重比较修正，对策略排名的可信度进行分级：

| 等级 | 标准 | 含义 |
|------|------|------|
| ★★★ | 所有三种检验均在5%水平显著 + Romano-Wolf通过 | 强显著性 |
| ★★ | 至少两种检验在5%水平显著 | 中等显著性 |
| ★ | 至少一种检验在10%水平显著 | 弱显著性 |
| — | 无检验显著 | 不显著 |

---

## 2.6.5 本章小结

本章建立了从理论假说到模型构建、从静态分析到动态框架、从点估计到统计推断的完整理论体系。核心内容总结如下：

### 理论架构

```
§2.1 理论基础
  ├── 现代资产配置理论 (MV → BL → RP → HRP)
  ├── 复杂网络理论 (中心性 + 社区结构)
  └── 协方差估计 (Ledoit-Wolf + GLASSO + ★RMT去噪)

§2.2 图模型构建
  ├── 距离变换 (标准 + 替代)
  ├── 网络过滤 (MST + PMFG + GLASSO)
  └── 显著性检验 (RMT + 随机对比 + 重连检验)

§2.3 理论衔接与策略体系
  ├── 命题1: 中心性-风险传染
  ├── 命题2: 社区-分散化
  ├── ★命题3: 网络信息的正确使用层次
  └── 13种策略分类 (基准 + 传统 + 图规则 + 融合)

§2.4 ★融合创新方法 (核心贡献)
  ├── 诊断: 简单网络规则失效机制
  ├── NRRP: 中心性正则化RP
  ├── ★Graph-BL: 中心性 → BL观点 (改善μ)
  ├── ★Denoised-RP: RMT去噪 → RP (改善Σ)
  └── ★Community-BL-RP: 社区×BL×中心性 (全面融合)

§2.5 动态配置框架
  ├── 滚动窗口网络构建
  ├── 网络稳定性度量 (J + ρ_s + NMI)
  └── 自适应调仓规则

§2.6 统计检验与稳健性
  ├── 三种统计检验 (LW + Bootstrap + DM)
  ├── Romano-Wolf多重比较修正
  └── 七项稳健性检验
```

### v2版本的三项核心升级

1. **新增命题3**（§2.3.1）：揭示网络信息应用于改善输入估计的理论洞见
2. **三种融合方法**（§2.4.3-2.4.5）：将网络信息从"权重调整"层面提升至"输入估计改善"层面
3. **完整评价框架**（§2.6.4）：多维度、跨状态、统计可信的综合评价体系

---

## 参考文献（本节）

- Ledoit, O., & Wolf, M. (2008). Robust performance hypothesis testing with the Sharpe ratio. *Journal of Empirical Finance*, 15(5), 850-859.
- Politis, D. N., & Romano, J. P. (1994). The stationary bootstrap. *JASA*, 89(428), 1303-1313.
- Diebold, F. X., & Mariano, R. S. (1995). Comparing predictive accuracy. *Journal of Business & Economic Statistics*, 13(3), 253-263.
- Romano, J. P., & Wolf, M. (2005). Stepwise multiple testing as formalized data snooping. *Econometrica*, 73(4), 1237-1282.
