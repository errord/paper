## 基于图模型的资产配置策略研究——以华西证券自营投资为例（代理资产池实证）

（成人高考金融学本科毕业论文写作版本，基于公开数据与可复现代码实现）

---

### 摘要

证券公司自营投资业务在市场波动加剧与资产相关性增强的背景下，对“相关结构—风险传导—组合约束”的刻画提出更高要求。传统均值—方差框架主要依赖协方差矩阵与期望收益率参数，容易受到参数估计误差影响；而图模型方法能够从网络拓扑结构出发刻画资产之间的结构性关联，为风险识别与约束设计提供新的视角。

本文以华西证券自营投资为案例背景，**在不使用公司内部持仓数据**的前提下，基于公开市场数据构建“华西自营权益代理资产池”（30只代表性A股个股，2023–2025年日频收益率），计算相关系数矩阵并构建资产相关网络，采用最小生成树（MST）与平面最大过滤图（PMFG）提取网络骨干结构与社区结构，进一步将网络中心性与社区信息用于资产配置策略设计。实证部分采用滚动窗口样本外回测（窗口252个交易日、按月调仓），对20种策略进行对比：包含等权、风险平价、层次化风险平价（HRP）、Black–Litterman（BL）、最小方差（MinVar）、以及多种网络融合策略。

可复现的回测结果显示：在本文样本期内，**最小方差（MinVar）**取得最高风险调整后收益（年化收益22.99%，年化波动13.48%，Sharpe 1.705，最大回撤-9.10%）；在图模型融合方向上，本文提出的**网络约束MinVar**与**社区MinVar**在保持低波动优势的同时提高分散化水平（有效资产数分别为14.37与15.72），并在统计检验中相对等权组合呈现显著差异（Diebold–Mariano检验p值分别为0.0052与0.0037）。同时，简单的“中心性直接映射权重”策略在本文数据上整体不优于基准，说明图模型更适合用于改善输入估计或约束结构，而非直接替代风险模型。

本文结论对券商自营投资具有现实启示：在权益仓位有限、风险管理强调稳健性的场景下，优先采用“低估计误差”的配置框架（如MinVar、RP/HRP）更为稳健；图模型方法的价值更适合体现在**系统性风险识别**与**约束/分层结构设计**，从而增强组合的风险控制与分散化效果。

**关键词**：图模型；资产配置；证券公司自营投资；最小生成树；最小方差；网络中心性；社区结构

---

### 目录

- 第一章 绪论  
- 第二章 理论基础与方法  
- 第三章 数据来源与研究设计  
- 第四章 实证结果与分析  
- 第五章 结论、建议与局限  
- 参考文献  
- 附录（复现说明与输出文件清单）

---

## 第一章 绪论

### 1.1 研究背景

证券公司自营投资以自有资金参与资本市场投资，收益与风险控制能力直接影响公司盈利质量与抗风险能力。近年来在监管导向与市场结构变化下，自营投资更强调稳健收益与回撤控制；与此同时，资产间相关性在市场波动与行业轮动中呈现结构性变化，使得“仅看单个资产风险指标”的方法难以充分反映组合层面的系统性风险与风险传导路径。

传统资产配置方法以均值—方差框架为代表，核心输入为期望收益率（μ）与协方差矩阵（Σ）。在实际中，μ估计往往不稳定，导致组合权重不稳、换手率偏高。相比之下，图模型将资产视为节点、相关性视为边权，从网络结构角度刻画“谁与谁强相关”“哪些节点处于风险传导枢纽”“资产群落（社区）如何划分”，为自营投资的风险识别与约束设计提供补充工具。

### 1.2 研究意义

- **理论意义**：将资产配置从“资产—统计量”的二维框架扩展到“资产—关系—结构”的网络化框架，形成可解释的系统性风险刻画方式。  
- **实践意义**：在不依赖公司内部明细持仓的前提下，基于公开数据构建可落地的分析与回测流程，为自营投资提供可操作的组合构建与风险约束方案。

### 1.3 研究思路与创新点（适度简化版）

本文的研究路径为：数据→相关性→网络→策略→回测评估。

本文主要创新点（与可复现实证一致）：

1. **提出并实现两种图模型+MinVar融合策略**：  
   - 网络约束MinVar：用中心性信息设计“自适应权重上界”，降低对系统枢纽资产的集中暴露；  
   - 社区MinVar：用社区结构实现“跨社区分散化 + 社区内MinVar”，在保持低波动优势的同时提升有效分散度。
2. 通过样本外滚动回测与统计检验，验证“图模型不宜直接映射权重”的现象：简单中心性权重策略在本文数据上整体不优于基准，但**融合策略**可在稳健性上带来增益。

---

## 第二章 理论基础与方法

### 2.1 资产配置基础模型（简要）

#### 2.1.1 均值—方差模型（Markowitz）

在约束条件下最大化风险调整后的效用：

$$
\max_{\mathbf{w}}\ \mathbf{w}^\top\boldsymbol{\mu} - \frac{\lambda}{2}\mathbf{w}^\top\boldsymbol{\Sigma}\mathbf{w}
$$

$$
\text{s.t.}\ \mathbf{w}^\top\mathbf{1}=1,\ 0\le w_i\le \beta_{\max}
$$

#### 2.1.2 最小方差（MinVar）

不估计μ，仅最小化组合方差：

$$
\min_{\mathbf{w}}\ \mathbf{w}^\top\boldsymbol{\Sigma}\mathbf{w}
\quad\text{s.t.}\ \mathbf{w}^\top\mathbf{1}=1,\ 0\le w_i\le \beta_{\max}
$$

MinVar的实务优势在于避免μ估计误差。Jagannathan & Ma（2003）指出，上界约束等价于对协方差矩阵的隐式收缩，可提高样本外稳健性。

#### 2.1.3 风险平价与HRP（用于稳健对比）

风险平价通过让各资产（或各簇）风险贡献接近一致分配权重；HRP在层次聚类树上进行分配，减少协方差矩阵求逆的敏感性。

### 2.2 图模型方法

#### 2.2.1 相关性—距离转换与网络构建

本文以收益率相关系数 $\rho_{ij}$ 构建距离：

$$
d_{ij} = \sqrt{2(1-\rho_{ij})}
$$

并据此构建：

- **MST（最小生成树）**：保留网络骨干结构（30节点、29边），便于解释与可视化。  
- **PMFG（平面最大过滤图）**：保留更多重要关联（30节点、84边），便于中心性与社区分析。

#### 2.2.2 中心性与社区

中心性指标用于衡量节点在网络中的重要性，其中介数中心性常用于刻画“风险传导枢纽”。社区划分用于刻画“资产群落”，便于做分层配置与跨簇分散化设计。

### 2.3 图模型如何用于资产配置：从“直接映射”到“融合约束”

为降低复杂度，本文将图模型融入资产配置主要通过两种方式：

1. **改约束不改目标（网络约束MinVar）**：保持MinVar结构，利用中心性信息对权重上界进行差异化设置；  
2. **分层框架（社区MinVar）**：跨社区用风险平价做分散化，社区内用MinVar做低波动优化，并叠加中心性约束。

---

## 第三章 数据来源与研究设计

### 3.1 数据来源（公开数据，可复现）

本文使用公开数据源获取日频收盘价并计算收益率，数据获取与清洗流程由项目脚本实现（`data_fetch.py`）。核心预处理步骤为：

- 对数收益率：$r_t = \ln(P_t/P_{t-1})$  
- 极端值缩尾（Winsorize）：按单资产均值±5σ截断  
- 数据按年保存（2023/2024/2025）并合并生成 `data/all/returns_all.csv`

代理资产池（`data/all/meta.csv`）共32个标的，其中包含30只A股个股与2个宽基指数。回测时为保持策略可比性与避免指数与个股混杂，按实现逻辑**剔除名称包含“指数”的列**，最终用于回测的资产数为30。

### 3.2 研究设计与回测设置（与代码一致）

为保证结果真实可复现，本文严格采用项目主程序 `run_full_analysis.py` 的统一回测设置：

- **样本区间**：2023-01-04 至 2025-12-31（日频）  
- **滚动窗口**：252个交易日（约1年）  
- **调仓频率**：21个交易日（约1月）  
- **样本外天数**：474天（见绩效表n_days列）  
- **协方差估计**：Ledoit–Wolf收缩估计（提高稳定性）  

### 3.3 评价指标

本文采用年化收益、年化波动、Sharpe比率、最大回撤、CVaR(95%)、Calmar比率、换手率、有效资产数等指标进行评估。统计检验部分采用：

- Ledoit–Wolf Sharpe差异检验  
- Block Bootstrap（对Sharpe差异稳健检验）  
- Diebold–Mariano（收益序列预测误差差异检验）

---

## 第四章 实证结果与分析

### 4.1 网络结构特征（分年）

根据 `results/tables/table1_topology.csv`，三年网络特征如下（核心结果摘录）：

- 每年MST均为30节点、29边；PMFG均为84边，平均度约5.6。  
- PMFG模块度（modularity）在0.40–0.52之间，表明存在较明显的社区结构。  
- RMT信号特征值数量为2–3个，说明相关结构存在低维“共同因子”特征。

这些结构事实支持将网络信息用于“风险传导识别”与“社区分散化设计”。

### 4.2 20种策略样本外回测结果（真实表7）

本文20种策略的样本外绩效（完整数据见 `results/tables/table7_performance.csv`）。这里列出关键结论（直接来自表7）：

- **最优Sharpe**：◆最小方差（MinVar）Sharpe=1.705，年化收益22.99%，年化波动13.48%，最大回撤-9.10%。  
- **图模型+MinVar融合**：  
  - ◆网络约束MinVar：Sharpe=1.6665，最大回撤-9.18%，有效资产数14.37；  
  - ◆社区MinVar：Sharpe=1.6009，最大回撤-9.62%，有效资产数15.72（分散化更高但换手更高）。  
- **图模型简单规则整体不占优**：反中心性/直接中心性/PageRank的Sharpe分别为0.9906/0.9154/0.9424，均低于等权（1.0174）。  
- **融合型图模型策略中表现较好者**：★网络增强BL（Sharpe=1.4007），但仍低于MinVar与两种Graph-MinVar融合。

### 4.3 为什么MinVar表现最好？（结合真实诊断结论）

结合本文的实现与样本特征，MinVar表现好的原因可用“少估计、少噪声、稳约束”概括：

1. **不估计μ**：避免了期望收益估计误差带来的权重不稳定；  
2. **收缩协方差 + 权重上界**：提高数值稳定性、降低极端集中；  
3. **样本期结构**：2023–2025期间，低波动/高稳定行业（如银行、部分消费与公用属性）对风险调整后收益贡献较大，MinVar天然受益。

### 4.4 图模型如何“真实提升”配置效果？

本文实证表明：图模型并非“直接替代均值—方差”，其更合理的用法是：

- **用于约束与分层设计**（本文Net-MinVar与Comm-MinVar）：在不破坏MinVar稳健结构的前提下，引入“系统枢纽风险控制”与“跨社区分散化”；  
- **用于改善输入估计**（如Graph-BL、去噪RP等）：让网络信息参与μ或Σ的稳健估计，再交给成熟的优化框架求权重。

### 4.5 统计检验（真实表8的关键结论）

相对等权组合（基准），表8显示：

- ◆网络约束MinVar：DM检验 p=0.0052（显著）  
- ◆社区MinVar：DM检验 p=0.0037（显著）  
- ◆最小方差（MinVar）：DM检验 p=0.0059（显著）

说明在本文样本外区间内，上述策略在收益序列层面与基准存在统计差异（但Romano–Wolf多重比较修正后更严格，论文写作中建议如实说明“多重比较下显著性会变弱”，避免夸大）。

---

## 第五章 结论、建议与局限

### 5.1 研究结论

1. 代理资产池的相关网络具有显著的模块化与低维共同因子特征，为引入图模型提供了结构依据。  
2. 在本文样本期与资产池下，**最小方差（MinVar）**取得最优风险调整后收益。  
3. 图模型的价值更适合体现在**融合**：通过中心性与社区信息改造约束或分层结构，可在保持低波动的基础上提升分散化与稳健性（Net-MinVar、Comm-MinVar）。  
4. 简单的中心性权重规则在本文数据上不优于基准，提示图模型策略需要与传统风险模型结合。

### 5.2 对华西证券自营投资的建议（可操作、不过度拔高）

1. **权益配置层面**：优先采用MinVar/RP/HRP等“低估计误差”的稳健框架作为底仓方法。  
2. **风险控制层面**：引入网络中心性作为“系统性风险暴露”的度量，将其落到权重上界与集中度约束中（对应Net-MinVar思想）。  
3. **分散化层面**：引入社区结构做跨社区分散化（对应Comm-MinVar思想），在行业集中度较高时可提升组合韧性。  
4. **制度化流程**：建立月度更新的“相关网络—中心性—社区”监测报表，作为投委会配置讨论的补充材料。

### 5.3 局限性与展望

1. 本文以公开数据构建代理资产池，未使用华西证券内部真实持仓，结论主要反映“方法可行性与相对比较”，不等同于对公司真实组合的直接结论。  
2. 本文主要基于相关性网络，未引入更复杂的非线性依赖结构（如尾部相关、Copula）。  
3. 未来可扩展：将固收/衍生品代理资产纳入统一收益风险框架；引入时变网络与状态切换模型，提升对不同市场阶段的适配。

---

## 参考文献（建议保留精简且权威）

- Markowitz, H. (1952). Portfolio selection. *Journal of Finance*, 7(1), 77–91.  
- Black, F., & Litterman, R. (1992). Global portfolio optimization. *Financial Analysts Journal*, 48(5), 28–43.  
- Jagannathan, R., & Ma, T. (2003). Risk reduction in large portfolios: Why imposing the wrong constraints helps. *Journal of Finance*, 58(4), 1651–1683.  
- Ledoit, O., & Wolf, M. (2004). A well-conditioned estimator for large-dimensional covariance matrices. *Journal of Multivariate Analysis*, 88(2), 365–411.  
- Mantegna, R. N. (1999). Hierarchical structure in financial markets. *European Physical Journal B*, 11, 193–197.  
- Tumminello, M., Aste, T., Di Matteo, T., & Mantegna, R. N. (2005). A tool for filtering information in complex systems. *PNAS*, 102(30), 10421–10426.  
- Maillard, S., Roncalli, T., & Teiletche, J. (2010). The properties of equally weighted risk contribution portfolios. *Journal of Portfolio Management*, 36(4), 60–70.  
- López de Prado, M. (2016). Building diversified portfolios that outperform out of sample. *Journal of Portfolio Management*, 42(4), 59–69.  
- DeMiguel, V., Garlappi, L., & Uppal, R. (2009). Optimal versus naive diversification. *Review of Financial Studies*, 22(5), 1915–1953.  
- Pozzi, F., Di Matteo, T., & Aste, T. (2013). Spread of risk across financial markets: better to invest in the peripheries. *Scientific Reports*, 3, 1665.  
- Výrost, T., Lyócsa, Š., & Baumöhl, E. (2019). Network-based asset allocation strategies. *The North American Journal of Economics and Finance*, 47, 516–536.

---

## 附录A：复现说明（保证“真实、可查、可复现”）

### A.1 数据获取与预处理

- 数据抓取与预处理脚本：`data_fetch.py`  
- 输出目录：`data/2023/`、`data/2024/`、`data/2025/`、`data/all/`  
- 日收益率文件：`data/all/returns_all.csv`

### A.2 全流程分析与论文表图输出

运行：

```bash
python run_full_analysis.py
```

输出目录：

- 表格：`results/tables/`（含 `table7_performance.csv`, `table8_statistical_tests.csv` 等）  
- 图形：`results/figures/`（累计净值、回撤、网络图等）

